<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>사업자 인증 - INABOOTH</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" rel="stylesheet">
  <link rel="stylesheet" href="components/shared.css">
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    .modal-page {
      padding-top: calc(var(--header-height) + var(--space-8));
      min-height: 100vh;
      padding-bottom: var(--space-8);
      background: var(--color-bg-secondary);
    }

    .modal-card {
      background: white;
      border-radius: var(--radius-xl);
      padding: var(--space-8);
      box-shadow: var(--shadow-card);
      max-width: 560px;
      margin: 0 auto;
    }

    .modal-header {
      text-align: center;
      margin-bottom: var(--space-8);
    }

    .modal-header__icon {
      width: 64px;
      height: 64px;
      background: var(--color-primary-light);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-4);
    }

    .modal-header__icon i {
      color: var(--color-primary);
      width: 28px;
      height: 28px;
    }

    .modal-header__title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      margin-bottom: var(--space-2);
    }

    .modal-header__desc {
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
    }

    .step-indicator {
      display: flex;
      justify-content: center;
      gap: var(--space-2);
      margin-bottom: var(--space-8);
    }

    .step-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--color-border);
      transition: all var(--transition-fast);
    }

    .step-dot.active {
      background: var(--color-primary);
      width: 24px;
      border-radius: var(--radius-full);
    }

    .step-dot.completed {
      background: var(--color-success);
    }

    .form-step {
      display: none;
    }

    .form-step.active {
      display: block;
    }

    .form-group {
      margin-bottom: var(--space-5);
    }

    .form-label {
      display: block;
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      margin-bottom: var(--space-2);
      color: var(--color-text-primary);
    }

    .form-label .required {
      color: var(--color-error);
    }

    .form-input {
      width: 100%;
      padding: var(--space-3) var(--space-4);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      transition: all var(--transition-fast);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px var(--color-primary-light);
    }

    .form-hint {
      font-size: var(--font-size-xs);
      color: var(--color-text-tertiary);
      margin-top: var(--space-2);
    }

    .form-error {
      font-size: var(--font-size-xs);
      color: var(--color-error);
      margin-top: var(--space-2);
      display: none;
    }

    .biz-number-group {
      display: flex;
      gap: var(--space-2);
    }

    .biz-number-group .form-input {
      text-align: center;
    }

    .biz-number-group .form-input:first-child {
      width: 80px;
    }

    .biz-number-group .form-input:nth-child(2) {
      width: 60px;
    }

    .biz-number-group .form-input:last-child {
      flex: 1;
    }

    .biz-number-group span {
      display: flex;
      align-items: center;
      color: var(--color-text-tertiary);
    }

    .file-upload {
      border: 2px dashed var(--color-border);
      border-radius: var(--radius-md);
      padding: var(--space-6);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .file-upload:hover {
      border-color: var(--color-primary);
      background: var(--color-primary-light);
    }

    .file-upload__icon {
      width: 40px;
      height: 40px;
      background: var(--color-bg-secondary);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-3);
    }

    .file-upload__text {
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
    }

    .file-upload__text span {
      color: var(--color-primary);
      font-weight: var(--font-weight-medium);
    }

    .file-upload__hint {
      font-size: var(--font-size-xs);
      color: var(--color-text-tertiary);
      margin-top: var(--space-2);
    }

    .file-preview {
      display: none;
      background: var(--color-bg-secondary);
      border-radius: var(--radius-md);
      padding: var(--space-3);
      margin-top: var(--space-3);
    }

    .file-preview.show {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .file-preview__icon {
      width: 36px;
      height: 36px;
      background: white;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .file-preview__info {
      flex: 1;
    }

    .file-preview__name {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
    }

    .file-preview__size {
      font-size: var(--font-size-xs);
      color: var(--color-text-tertiary);
    }

    .file-preview__remove {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--color-text-tertiary);
      padding: var(--space-1);
    }

    .file-preview__remove:hover {
      color: var(--color-error);
    }

    .info-box {
      background: var(--color-bg-secondary);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      margin-bottom: var(--space-6);
    }

    .info-box__title {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      margin-bottom: var(--space-2);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .info-box__title i {
      width: 16px;
      height: 16px;
      color: var(--color-primary);
    }

    .info-box__list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .info-box__list li {
      font-size: var(--font-size-xs);
      color: var(--color-text-secondary);
      margin-bottom: var(--space-1);
      padding-left: var(--space-4);
      position: relative;
    }

    .info-box__list li::before {
      content: "•";
      position: absolute;
      left: var(--space-1);
      color: var(--color-text-tertiary);
    }

    .review-info {
      background: var(--color-warning-light);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      text-align: center;
    }

    .review-info__icon {
      width: 48px;
      height: 48px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-3);
    }

    .review-info__icon i {
      color: var(--color-warning);
      width: 24px;
      height: 24px;
    }

    .review-info__title {
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      margin-bottom: var(--space-2);
    }

    .review-info__desc {
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
    }

    .success-message {
      text-align: center;
      padding: var(--space-6) 0;
    }

    .success-message__icon {
      width: 80px;
      height: 80px;
      background: var(--color-success-light);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-4);
    }

    .success-message__icon i {
      color: var(--color-success);
      width: 40px;
      height: 40px;
    }

    .success-message__title {
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
      margin-bottom: var(--space-2);
    }

    .success-message__desc {
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
    }

    .modal-actions {
      display: flex;
      gap: var(--space-3);
      margin-top: var(--space-6);
    }

    .modal-actions .btn {
      flex: 1;
    }
  </style>
</head>
<body>
  <div id="header-placeholder"></div>

  <main class="modal-page">
    <div class="container">
      <div class="modal-card">
        <div class="modal-header">
          <div class="modal-header__icon">
            <i data-lucide="building-2"></i>
          </div>
          <h1 class="modal-header__title">사업자 인증</h1>
          <p class="modal-header__desc">사업자등록증을 통해 사업자 인증을 진행합니다.</p>
        </div>

        <div class="step-indicator">
          <div class="step-dot active" id="dot1"></div>
          <div class="step-dot" id="dot2"></div>
          <div class="step-dot" id="dot3"></div>
        </div>

        <!-- Step 1: 사업자 정보 입력 -->
        <div class="form-step active" id="step1">
          <div class="form-group">
            <label class="form-label" for="bizNumber">사업자등록번호 <span class="required">*</span></label>
            <div class="biz-number-group">
              <input type="text" class="form-input" id="bizNum1" maxlength="3" placeholder="000">
              <span>-</span>
              <input type="text" class="form-input" id="bizNum2" maxlength="2" placeholder="00">
              <span>-</span>
              <input type="text" class="form-input" id="bizNum3" maxlength="5" placeholder="00000">
            </div>
            <p class="form-error" id="bizNumError"></p>
          </div>

          <div class="form-group">
            <label class="form-label" for="companyName">상호명 <span class="required">*</span></label>
            <input type="text" class="form-input" id="companyName" placeholder="상호명을 입력하세요">
            <p class="form-error" id="companyNameError"></p>
          </div>

          <div class="form-group">
            <label class="form-label" for="repName">대표자명 <span class="required">*</span></label>
            <input type="text" class="form-input" id="repName" placeholder="대표자명을 입력하세요">
            <p class="form-error" id="repNameError"></p>
          </div>

          <div class="modal-actions">
            <a href="9-2 설정.html" class="btn btn--secondary">취소</a>
            <button class="btn btn--primary" onclick="goToStep(2)">
              다음
              <i data-lucide="arrow-right" class="icon icon-sm"></i>
            </button>
          </div>
        </div>

        <!-- Step 2: 서류 업로드 -->
        <div class="form-step" id="step2">
          <div class="info-box">
            <div class="info-box__title">
              <i data-lucide="info"></i>
              인증 서류 안내
            </div>
            <ul class="info-box__list">
              <li>사업자등록증 사본이 필요합니다</li>
              <li>파일 형식: PDF, JPG, PNG (최대 10MB)</li>
              <li>서류가 선명하게 보이도록 촬영해주세요</li>
              <li>개인정보 마스킹은 하지 않아도 됩니다</li>
            </ul>
          </div>

          <div class="form-group">
            <label class="form-label">사업자등록증 <span class="required">*</span></label>
            <div class="file-upload" id="fileUpload" onclick="document.getElementById('fileInput').click()">
              <div class="file-upload__icon">
                <i data-lucide="upload" class="icon"></i>
              </div>
              <p class="file-upload__text">
                <span>클릭하여 업로드</span> 또는 드래그 앤 드롭
              </p>
              <p class="file-upload__hint">PDF, JPG, PNG (최대 10MB)</p>
            </div>
            <input type="file" id="fileInput" accept=".pdf,.jpg,.jpeg,.png" style="display:none">
            <div class="file-preview" id="filePreview">
              <div class="file-preview__icon">
                <i data-lucide="file-text"></i>
              </div>
              <div class="file-preview__info">
                <div class="file-preview__name" id="fileName">사업자등록증.pdf</div>
                <div class="file-preview__size" id="fileSize">1.2 MB</div>
              </div>
              <button class="file-preview__remove" onclick="removeFile()">
                <i data-lucide="x"></i>
              </button>
            </div>
            <p class="form-error" id="fileError"></p>
          </div>

          <div class="modal-actions">
            <button class="btn btn--secondary" onclick="goToStep(1)">이전</button>
            <button class="btn btn--primary" onclick="submitApplication()">
              인증 신청
              <i data-lucide="send" class="icon icon-sm"></i>
            </button>
          </div>
        </div>

        <!-- Step 3: 심사 중 / 완료 -->
        <div class="form-step" id="step3">
          <div class="review-info">
            <div class="review-info__icon">
              <i data-lucide="clock"></i>
            </div>
            <h2 class="review-info__title">인증 심사 중</h2>
            <p class="review-info__desc">
              사업자 인증 신청이 접수되었습니다.<br>
              심사는 영업일 기준 1~2일 내에 완료됩니다.<br>
              결과는 이메일과 알림으로 안내해드립니다.
            </p>
          </div>

          <div class="modal-actions">
            <a href="9-2 설정.html" class="btn btn--primary" style="flex: 1;">
              <i data-lucide="check" class="icon icon-sm"></i>
              확인
            </a>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div id="footer-placeholder"></div>
  <script src="components/shared.js"></script>
  <script>
    initPage({activePage:'mypage', isLoggedIn: true});
    lucide.createIcons();

    let uploadedFile = null;

    // 사업자번호 자동 포커스 이동
    document.getElementById('bizNum1').addEventListener('input', function() {
      if (this.value.length === 3) document.getElementById('bizNum2').focus();
    });
    document.getElementById('bizNum2').addEventListener('input', function() {
      if (this.value.length === 2) document.getElementById('bizNum3').focus();
    });

    // 파일 업로드
    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        if (file.size > 10 * 1024 * 1024) {
          Toast.error('파일 크기는 10MB 이하여야 합니다.');
          return;
        }
        uploadedFile = file;
        document.getElementById('fileName').textContent = file.name;
        document.getElementById('fileSize').textContent = formatFileSize(file.size);
        document.getElementById('filePreview').classList.add('show');
        document.getElementById('fileUpload').style.display = 'none';
        lucide.createIcons();
      }
    });

    function removeFile() {
      uploadedFile = null;
      document.getElementById('fileInput').value = '';
      document.getElementById('filePreview').classList.remove('show');
      document.getElementById('fileUpload').style.display = 'block';
    }

    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
    }

    function goToStep(step) {
      // Step 1 유효성 검사
      if (step === 2) {
        const bizNum1 = document.getElementById('bizNum1').value;
        const bizNum2 = document.getElementById('bizNum2').value;
        const bizNum3 = document.getElementById('bizNum3').value;
        const companyName = document.getElementById('companyName').value;
        const repName = document.getElementById('repName').value;

        let hasError = false;

        if (!bizNum1 || !bizNum2 || !bizNum3 || bizNum1.length < 3 || bizNum2.length < 2 || bizNum3.length < 5) {
          document.getElementById('bizNumError').textContent = '올바른 사업자등록번호를 입력해주세요.';
          document.getElementById('bizNumError').style.display = 'block';
          hasError = true;
        } else {
          document.getElementById('bizNumError').style.display = 'none';
        }

        if (!companyName) {
          document.getElementById('companyNameError').textContent = '상호명을 입력해주세요.';
          document.getElementById('companyNameError').style.display = 'block';
          hasError = true;
        } else {
          document.getElementById('companyNameError').style.display = 'none';
        }

        if (!repName) {
          document.getElementById('repNameError').textContent = '대표자명을 입력해주세요.';
          document.getElementById('repNameError').style.display = 'block';
          hasError = true;
        } else {
          document.getElementById('repNameError').style.display = 'none';
        }

        if (hasError) return;
      }

      document.querySelectorAll('.form-step').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.step-dot').forEach(el => {
        el.classList.remove('active', 'completed');
      });

      document.getElementById(`step${step}`).classList.add('active');
      document.getElementById(`dot${step}`).classList.add('active');

      for (let i = 1; i < step; i++) {
        document.getElementById(`dot${i}`).classList.add('completed');
      }

      lucide.createIcons();
    }

    function submitApplication() {
      if (!uploadedFile) {
        document.getElementById('fileError').textContent = '사업자등록증을 업로드해주세요.';
        document.getElementById('fileError').style.display = 'block';
        return;
      }

      document.getElementById('fileError').style.display = 'none';
      Toast.success('사업자 인증 신청이 접수되었습니다.');
      goToStep(3);
    }
  </script>
</body>
</html>
